/*! Brytescore JavaScript library v0.3.4
 *  Copyright 2015-2017 Brytecore, Inc
 */
/*! Brytescore JavaScript library v0.3.4
 *  Copyright 2015-2017 Brytecore, Inc
 */
!function(a,b){"use strict";function c(a,b,f,g){if(O?N&&(l=new XMLHttpRequest,l.open("POST",N,!0),l.setRequestHeader("Content-type","application/json")):l=d("Post",w+"/"+a),null!==l){var h=b.indexOf("."),i={event:b,eventDisplayName:f,hostName:location.hostname,apiKey:m,anonymousId:n,userId:o.toString(),pageViewId:q,sessionId:p,library:H,libraryVersion:I,schemaVersion:-1===h?J.analytics:J[b.substring(0,h)],data:g||{}};O&&(i.brytecoreUrl=w+"/"+a),L&&(i.validationOnly=L),l.onload=e,l.onerror=function(d){O=!0,c(a,b,f,g)},i=JSON.stringify(i),K?console.log(i):l.send(i)}}function d(b,c){var d=new XMLHttpRequest;return"withCredentials"in d?(d.open(b,c,!0),d.setRequestHeader("Content-Type","application/json")):"undefined"!=typeof XDomainRequest?a.navigator.userAgent.match(/MSIE [6-9]/)?(c=c.replace(/^http(?:s)?\:/,a.location.protocol),d=new XDomainRequest,d.open(b,c)):(d=new XDomainRequest,d.open(b,c),d.setRequestHeader("Content-Type","application/json")):d=null,d}function e(){var a=l.responseText;if(a&&""!==a&&(a=JSON.parse(a),a&&a.hasOwnProperty("code")))switch(a.code.toLowerCase()){case"success":break;case"unauthorizederror":break;case"badrequesterror":P("The request was not properly formatted.")}}function f(b){g(),o=b,n=brytescore.generateUUID(),p=brytescore.generateUUID();var c=navigator.userAgent;G=!1;var d=JSON.stringify({aid:n,uid:b}),e=new Date;e.setTime(e.getTime()+x),R("brytescore_uu",d,e.toUTCString()),brytescore.boost("sessionStarted","started new session",{sessionId:p,browserUA:c,anonymousId:n}),a.brytescore.pageView({})}function g(){brytescore.killHeartbeat(),R("brytescore_session",null,new Date(1974,9,18)),p=b,G=!0,q=b}function h(){t.removeListener?(t.removeListener("mousemove",S),t.removeListener("click",S),t.removeListener("keyup",S),t.removeListener("scroll",S)):t.detachEvent&&(t.detachEvent("onmousemove",S),t.detachEvent("onkeyup",S),t.detachEvent("onclick",S),t.detachEvent("onscroll",S)),t=b}function i(){clearInterval(E),E=0,s=setTimeout(function(){g()},15e5),t=a,t.addEventListener?(t.addEventListener("mousemove",S),t.addEventListener("click",S),t.addEventListener("scroll",S),t.addEventListener("keyup",S)):t.attachEvent&&(t.attachEvent("onmousemove",S),t.attachEvent("onclick",S),t.attachEvent("onscroll",S),t.attachEvent("onkeyup",S))}function j(a,b){var c=document.createElement("script");c.src=a,c.async=!0,c.onreadystatechange=c.onload=function(){var a=c.readyState;b.done||a&&!/loaded|complete/.test(a)||(b.done=!0,b())},document.getElementsByTagName("head")[0].appendChild(c)}Array.prototype.indexOf||(Array.prototype.indexOf=function(a,c){b===c?c=0:0>c&&(c+=this.length,0>c&&(c=0));for(var d=this.length;c<d;c++)if(c in this&&this[c]===a)return c;return-1});var k,l,m,n,o,p,q,r,s,t,u=brytescore.q,v=[],w="https://api.brytecore.com",x=31536e6,y="heartBeat",z="pageView",A="impersonate",B=0,C=15e3,D=0,E=0,F="",G=!1,H="javascript",I="0.3.5",J={analytics:"0.3.1"},K=!1,L=!1,M=!1,N="",O=!1,P=function(a){console.log("Brytescore error: "+a)},Q=function(a){a+="=";for(var b=document.cookie.split(";"),c=0;c<b.length;c++){for(var d=b[c];" "===d.charAt(0);)d=d.substring(1);if(-1!==d.indexOf(a))return d.substring(a.length,d.length)}return null},R=function(a,b,c){a=encodeURIComponent(a),b=encodeURIComponent(b),null!==c?document.cookie=a+"="+b+"; expires="+c+"; path=/":document.cookie=a+"="+b+"; path=/"};a.brytescore=function(){""===F&&(F=location.href);var b=location.href;b!==F&&(a.brytescore.killHeartbeat(),a.brytescore.pageView({}),F=b);var c,d=[].slice.call(arguments);if(0===d.length&&P("Invalid method name."),k=d.shift(),0<k.indexOf(".")){var e=k.split("."),f=e[0],g=e[1];c="object"==typeof a.brytescore[f]?a.brytescore[f][g]:null}else c=a.brytescore[k];"function"==typeof c?c.apply(a,d):brytescore.q.push([].slice.call(arguments))},a.brytescore.q=[],a.brytescore.on=function(a,b){v.push(a,b)},a.brytescore.emit=function(a,b){},a.brytescore.removeListener=function(a,b){for(var c=v,d=0;d<c.length;d++)a===c[d][0]&&b===c[d][1]&&v.splice(d,1)},a.brytescore.removeAllListeners=function(a){for(var b=v,c=0;c<b.length;c++)a===b[c][0]&&v.splice(c,1)},a.brytescore.authenticated=function(a){if(!(M||a&&a.isImpersonating)){var b,c,d,e=a.userAccount.id,g=Q("brytescore_uu");null!==g?(b=JSON.parse(decodeURIComponent(g)),""!==b.uid&&b.uid!=e?f(e):n=b.aid):n=brytescore.generateUUID(),c=JSON.stringify({aid:n,uid:e}),d=new Date,d.setTime(d.getTime()+x),R("brytescore_uu",c,d.toUTCString()),brytescore.boost("authenticated","Logged In",a)}},a.brytescore.submittedForm=function(a){M||a&&a.isImpersonating||brytescore.boost("submittedForm","Submitted a Form",a)},a.brytescore.startedChat=function(a){M||a&&a.isImpersonating||brytescore.boost("startedChat","User Started a Live Chat",a)},a.brytescore.updatedUserInfo=function(a){if(!(M||a&&a.isImpersonating)){var c=a.userAccount.id;if(b===o||c!==o){var d,e,f,g=Q("brytescore_uu");o=c,null!==g?(d=JSON.parse(decodeURIComponent(g)),n=d.aid):n=brytescore.generateUUID(),e=JSON.stringify({aid:n,uid:c}),f=new Date,f.setTime(f.getTime()+x),R("brytescore_uu",e,f.toUTCString())}brytescore.boost("updatedUserInfo","Updated User Information",a)}},a.brytescore.registeredAccount=function(a){if(!(M||a&&a.isImpersonating)){var c=a.userAccount.id;if(b===o||c!==o){var d,e,f,g=Q("brytescore_uu");o=c,null!==g?(d=JSON.parse(decodeURIComponent(g)),n=d.aid):n=brytescore.generateUUID(),e=JSON.stringify({aid:n,uid:c}),f=new Date,f.setTime(f.getTime()+x),R("brytescore_uu",e,f.toUTCString())}brytescore.boost("registeredAccount","Created a new account",a)}},a.brytescore.setAPIKey=function(a){m=a},a.brytescore.devMode=function(a){K=a},a.brytescore.validationMode=function(a){L=a},a.brytescore.localUrl=function(a){N=a},a.brytescore.impersonate=function(a){a.isImpersonating&&(M=!0,brytescore.boost(A,"Impersonated User",a))},a.brytescore.pageView=function(b){if(!(M||b&&b.isImpersonating)){D=0,q=brytescore.generateUUID(),b.pageUrl=a.location.href,b.pageTitle=document.title,b.referrer=document.referrer,brytescore.boost(z,"Viewed a Page",b);var c=navigator.userAgent;b=JSON.stringify({sid:p,brw:c,aid:n});var d=new Date;d.setTime(d.getTime()+18e5),R("brytescore_session",b,d.toUTCString()),brytescore.heartBeat(),r=a.setInterval(function(){var b=(new Date).getTime();0===B||18e5>b-B?(B=(new Date).getTime(),brytescore.heartBeat()):(B=0,g(),a.brytescore.updateCookies(),a.brytescore.pageView({}))},C)}},a.brytescore.killHeartbeat=function(){clearInterval(r)},a.brytescore.boost=function(a,b,d){M||d&&d.isImpersonating||c("boost",a,b,d)},a.brytescore.heartBeat=function(){a.brytescore.boost(y,"Heartbeat",{elapsedTime:D}),D+=C/1e3},a.brytescore.load=function(b,c){var e=d("GET",b);e.onload=function(){var b=e.readyState;if(!b||/loaded|complete/.test(b)||4===e.readyState&&200===e.status){var c=JSON.parse(e.responseText),d=c.events,f=c.namespace;J[f]=c.version,a.brytescore[f]={};for(var g in d){a.brytescore.factory=function(b,c,d){return function(){return a.brytescore.boost(c+"."+b,d,arguments[0])}},a.brytescore[f][g]=a.brytescore.factory(g,f,d[g].displayName);for(var h=0;h<a.brytescore.q.length;h++)f+"."+g===a.brytescore.q[h][0]&&a.brytescore[f][g](a.brytescore.q[h][1])}}},e.onerror=function(){c&&brytescore.load(c)},e.send(),a.brytescore.q=[]};for(var S=function(){0===E&&(b!==t&&h(),!0===G&&(a.brytescore.updateCookies(),a.brytescore.pageView({})),clearInterval(E),clearTimeout(s),E=a.setInterval(function(){i()},3e5))},T=[],U=0;256>U;U++)T[U]=(16>U?"0":"")+U.toString(16);a.brytescore.generateUUID=function(){var a=4294967295*Math.random()|0,b=4294967295*Math.random()|0,c=4294967295*Math.random()|0,d=4294967295*Math.random()|0;return T[255&a]+T[a>>8&255]+T[a>>16&255]+T[a>>24&255]+"-"+T[255&b]+T[b>>8&255]+"-"+T[b>>16&15|64]+T[b>>24&255]+"-"+T[63&c|128]+T[c>>8&255]+"-"+T[c>>16&255]+T[c>>24&255]+T[255&d]+T[d>>8&255]+T[d>>16&255]+T[d>>24&255]},a.brytescore.updateCookies=function(){var a,b,c,d,e=Q("brytescore_uu"),f=Q("brytescore_session");null!==e?(a=JSON.parse(decodeURIComponent(e)),n=a.aid,o=a.uid):(n=brytescore.generateUUID(),o=""),b=JSON.stringify({aid:n,uid:o}),c=new Date,c.setTime(c.getTime()+x),R("brytescore_uu",b,c.toUTCString()),null!==f&&!0!==G?(a=JSON.parse(decodeURIComponent(f)),p=a.sid):(p=brytescore.generateUUID(),d=navigator.userAgent,b=JSON.stringify({sid:p,brw:d,aid:n}),c=new Date,c.setTime(c.getTime()+18e5),R("brytescore_session",b,c.toUTCString()),null===e&&brytescore.boost("brytescoreUUIDCreated","New user id Created",{anonymousId:n}),null!==f&&!0!==G||(G=!1,brytescore.boost("sessionStarted","started new session",{sessionId:p,browserUA:d,anonymousId:n})))},a.brytescore.is_loaded=function(a){console.log("is_loaded function called for package "+a)},a.brytescore.processQueue=function(){for(var a=0;a<u.length;a++)brytescore.apply(document,u[a])},a.brytescore.init=function(){if("undefined"==typeof m)for(var a=0;a<u.length;a++)"setapikey"===u[a][0].toLowerCase()&&(brytescore.setAPIKey(u[a][1]),u.splice(a,1));brytescore.updateCookies(),brytescore.processQueue(),S()},"object"!=typeof JSON?j("https://cdn.brytecore.com/brytescore.js/JSON3.min.js",function(){brytescore.init()}):brytescore.init()}(window);